machine:
  ghc:
    version: 7.8.3
  environment:
    PATH: ~/.local/bin:$PATH

dependencies:
  override:
  - mkdir -p ~/.local/bin
  - curl -L https://github.com/commercialhaskell/stack/releases/download/v0.1.2.0/stack-0.1.2.0-x86_64-linux.gz | gunzip > ~/.local/bin/stack
  - chmod a+x ~/.local/bin/stack
  - stack setup --no-terminal
  - stack test --only-snapshot --prefetch --no-terminal
  - stack bench --only-snapshot --prefetch --no-terminal
  - stack haddock --only-snapshot --prefetch --no-terminal

  cache_directories:
  - "~/.stack/"

test:
  override:
  - stack build --haddock --pedantic --no-terminal
  - stack test --pedantic --no-terminal
  - stack bench --pedantic --no-terminal
